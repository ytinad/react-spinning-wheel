{"version":3,"file":"index.js","sources":["../src/index.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\"\n\nconst SpinningWheel = ({\n  options,\n  optColors,\n  winningOption,\n  onFinished,\n  primaryColor,\n  contrastColor,\n  buttonText,\n  isOnlyOnce = true,\n  size = 290,\n  upDuration = 100,\n  downDuration = 1000,\n  fontFamily = \"proxima-nova\",\n  autoSpin = false,\n}) => {\n  let currentSegment = \"\"\n  let isStarted = false\n  const [isFinished, setFinished] = useState(false)\n  let timerHandle = 0\n  const timerDelay = options.length\n  let angleCurrent = 0\n  let angleDelta = 0\n  let canvasContext = null\n  let maxSpeed = Math.PI / `${options.length}`\n  const upTime = options.length * upDuration\n  const downTime = options.length * downDuration\n  let spinStart = 0\n  let frames = 0\n  let centerMargin = size <= 220 ? 5 : 20\n  let centerX = size + centerMargin\n  let centerY = size + centerMargin\n  let canvasHeight = centerX * 2 + centerMargin * 2\n  let canvasWidth = centerY * 2 + centerMargin * 2\n  const wheelInit = () => {\n    initCanvas()\n    wheelDraw()\n  }\n\n  const initCanvas = () => {\n    let canvas = document.getElementById(\"canvas\")\n    if (navigator.appVersion.indexOf(\"MSIE\") !== -1) {\n      canvas = document.createElement(\"canvas\")\n      canvas.setAttribute(\"width\", canvasHeight)\n      canvas.setAttribute(\"height\", canvasWidth)\n      canvas.setAttribute(\"id\", \"canvas\")\n      document.getElementById(\"wheel\").appendChild(canvas)\n    }\n    if (!autoSpin) {\n      canvas.addEventListener(\"click\", spin, false)\n    }\n    canvasContext = canvas.getContext(\"2d\")\n  }\n  const spin = () => {\n    isStarted = true\n    if (timerHandle === 0) {\n      spinStart = new Date().getTime()\n      // maxSpeed = Math.PI / ((options.length*2) + Math.random())\n      maxSpeed = Math.PI / options.length\n      frames = 0\n      timerHandle = setInterval(onTimerTick, timerDelay)\n    }\n  }\n  const onTimerTick = () => {\n    frames++\n    draw()\n    const duration = new Date().getTime() - spinStart\n    let progress = 0\n    let finished = false\n    if (duration < upTime) {\n      progress = duration / upTime\n      angleDelta = maxSpeed * Math.sin((progress * Math.PI) / 2)\n    } else {\n      if (winningOption) {\n        if (currentSegment === winningOption && frames > options.length) {\n          progress = duration / upTime\n          angleDelta =\n            maxSpeed * Math.sin((progress * Math.PI) / 2 + Math.PI / 2)\n          progress = 1\n        } else {\n          progress = duration / downTime\n          angleDelta =\n            maxSpeed * Math.sin((progress * Math.PI) / 2 + Math.PI / 2)\n        }\n      } else {\n        progress = duration / downTime\n        angleDelta = maxSpeed * Math.sin((progress * Math.PI) / 2 + Math.PI / 2)\n      }\n      if (progress >= 1) finished = true\n    }\n\n    angleCurrent += angleDelta\n    while (angleCurrent >= Math.PI * 2) angleCurrent -= Math.PI * 2\n    if (finished) {\n      setFinished(true)\n      onFinished(currentSegment)\n      clearInterval(timerHandle)\n      timerHandle = 0\n      angleDelta = 0\n    }\n  }\n\n  const wheelDraw = () => {\n    clear()\n    drawWheel()\n    drawNeedle()\n  }\n\n  const draw = () => {\n    clear()\n    drawWheel()\n    drawNeedle()\n  }\n\n  const drawSegment = (key, lastAngle, angle) => {\n    const ctx = canvasContext\n    const value = options[key]\n    ctx.save()\n    ctx.beginPath()\n    ctx.moveTo(centerX, centerY)\n    ctx.arc(centerX, centerY, size, lastAngle, angle, false)\n    ctx.lineTo(centerX, centerY)\n    ctx.closePath()\n    ctx.fillStyle = optColors[key]\n    ctx.fill()\n    ctx.stroke()\n    ctx.save()\n    ctx.translate(centerX, centerY)\n    ctx.rotate((lastAngle + angle) / 2)\n    ctx.fillStyle = contrastColor || \"white\"\n    ctx.font = `bold ${size <= 220 ? 0.75 : 1}em ` + fontFamily\n    ctx.fillText(value.substr(0, 21), size / 2 + 20, 0)\n    ctx.restore()\n  }\n\n  const drawWheel = () => {\n    const ctx = canvasContext\n    let lastAngle = angleCurrent\n    const len = options.length\n    const PI2 = Math.PI * 2\n    ctx.lineWidth = 1\n    ctx.strokeStyle = primaryColor || \"black\"\n    ctx.textBaseline = \"middle\"\n    ctx.textAlign = \"center\"\n    ctx.font = `${size <= 220 ? 0.75 : 1}em ` + fontFamily\n    for (let i = 1; i <= len; i++) {\n      const angle = PI2 * (i / len) + angleCurrent\n      drawSegment(i - 1, lastAngle, angle)\n      lastAngle = angle\n    }\n\n    // Draw a center circle\n    ctx.beginPath()\n    ctx.arc(centerX, centerY, 50, 0, PI2, false)\n    ctx.closePath()\n    ctx.fillStyle = primaryColor || \"black\"\n    ctx.lineWidth = 10\n    ctx.strokeStyle = contrastColor || \"white\"\n    ctx.fill()\n    ctx.font = `bold ${size <= 220 ? 0.75 : 1}em ` + fontFamily\n    ctx.fillStyle = contrastColor || \"white\"\n    ctx.textAlign = \"center\"\n    if (!autoSpin) {\n      ctx.fillText(buttonText || \"Spin\", centerX, centerY + 3)\n    }\n    ctx.stroke()\n\n    // Draw outer circle\n    ctx.beginPath()\n    ctx.arc(centerX, centerY, size, 0, PI2, false)\n    ctx.closePath()\n\n    ctx.lineWidth = 10\n    ctx.strokeStyle = primaryColor || \"black\"\n    ctx.stroke()\n  }\n\n  const drawNeedle = () => {\n    const ctx = canvasContext\n    ctx.lineWidth = 1\n    ctx.strokeStyle = contrastColor || \"white\"\n    ctx.fileStyle = contrastColor || \"white\"\n    ctx.beginPath()\n    ctx.moveTo(centerX + 20, centerY - 50)\n    ctx.lineTo(centerX - 20, centerY - 50)\n    ctx.lineTo(centerX, centerY - 70)\n    ctx.closePath()\n    ctx.fill()\n    const change = angleCurrent + Math.PI / 2\n    let i =\n      options.length - Math.floor((change / (Math.PI * 2)) * options.length) - 1\n    if (i < 0) i = i + options.length\n    ctx.textAlign = \"center\"\n    ctx.textBaseline = \"middle\"\n    ctx.fillStyle = primaryColor || \"black\"\n    ctx.font = `bold ${size <= 220 ? 1 : 1.5}em ` + fontFamily\n    currentSegment = options[i]\n    isStarted && ctx.fillText(currentSegment, centerX + 10, centerY + size + 50)\n  }\n  const clear = () => {\n    const ctx = canvasContext\n    ctx.clearRect(0, 0, canvasHeight, canvasWidth)\n  }\n\n  useEffect(() => {\n    wheelInit()\n    setTimeout(() => {\n      window.scrollTo(0, 1)\n    }, 0)\n    if (autoSpin) {\n      spin()\n    }\n  }, [])\n  return (\n    <div id=\"wheel\">\n      <canvas\n        id=\"canvas\"\n        width={canvasWidth}\n        height={canvasHeight}\n        style={{\n          pointerEvents: isFinished && isOnlyOnce ? \"none\" : \"auto\",\n        }}\n      />\n    </div>\n  )\n}\nexport default SpinningWheel\n"],"names":["SpinningWheel","options","optColors","winningOption","onFinished","primaryColor","contrastColor","buttonText","isOnlyOnce","size","upDuration","downDuration","fontFamily","autoSpin","currentSegment","isStarted","useState","isFinished","setFinished","timerHandle","timerDelay","length","angleCurrent","angleDelta","canvasContext","maxSpeed","Math","PI","upTime","downTime","spinStart","frames","centerMargin","centerX","centerY","canvasHeight","canvasWidth","wheelInit","initCanvas","wheelDraw","canvas","document","getElementById","navigator","appVersion","indexOf","createElement","setAttribute","appendChild","addEventListener","spin","getContext","Date","getTime","setInterval","onTimerTick","draw","duration","progress","finished","sin","clearInterval","clear","drawWheel","drawNeedle","drawSegment","key","lastAngle","angle","ctx","value","save","beginPath","moveTo","arc","lineTo","closePath","fillStyle","fill","stroke","translate","rotate","font","fillText","substr","restore","len","PI2","lineWidth","strokeStyle","textBaseline","textAlign","i","fileStyle","change","floor","clearRect","useEffect","setTimeout","window","scrollTo","React","pointerEvents"],"mappings":"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"}